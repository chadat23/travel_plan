{% extends "shared/_layout.html" %}

{% block additional_css %}
    <!--<link rel="stylesheet" href="/static/css/plan_entry.css">-->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/plan_entry.css') }}">
{% endblock %}

{% block main_content %}

    <div class="hero">
        <h1>Enter Your Wilderness Travel Plan</h1>

        Notes: 
        <ul>
            <li>
                This tool is designed to work with a variety of sized screens (which we certainly have) and at a variety of resolutions (which again, we have). If things are too squished, making the web browser narrower may actually fix the problem.
            </li>
            <li>
                Name, email, and location fields can be either selected from dropdown list by clicking the text box, using the auto-complete after starting to enter a value, or typing in a novel value.
            </li>
            <li>
                For fields who's meanings aren't retaly apparent, hovering your curser over such fields will bring up an elaberating tip or hint.
            </li>
        </ul>
        
    </div>

    <div class="container">
        <form action="/travel/entry" method="POST" enctype=multipart/form-data>
            <div class="row entry-section">
                <div class="row col-lg-5">
                    <datalist id="locations">
                        {% for loc in locations %}
                            <option>{{ loc }}</option>
                        {% endfor %}
                    </datalist>
                    <div class="col-xl-2">Entry:</div>
                    <input type="date" name="entrydate" title="Entry Date" class="col-xl-3 date-input" value="{{ entry_date }}" required/>
                    <input type="text" name="entrypoint" placeholder="Entry Location" class="col-xl-7 text-input" value="{{ entry_point }}" list="locations" required/>
                </div>
                <div class="row col-lg-5">
                    <div class="col-xl-2">Exit:</div>
                    <input type="date" name="exitdate" title="Exit Date" class="col-xl-3 date-input" value="{{ exit_date }}" required/>
                    <input type="text" name="exitpoint" placeholder="Exit Location" class="col-xl-7" value="{{ exit_point }}" list="locations" required/>
                </div>
                <div class="row col-lg-2" >
                    <div class="col-xl-7" title="Will you be tracked by dispatch?">
                        <label class="radio-inline">
                            <input type="radio" name="tracked" id="tracked1" value="yes" {% if tracked %}checked{% else %}{% endif %} required>
                            Yes
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="tracked" id="tracked2" value="no" {% if not tracked %}checked{% else %}{% endif %} required>
                            No
                        </label>
                    </div>
                    <input type="text" name="plb" placeholder="PLB #" class="col-xl-5" value="{{ plb }}" required/>
                </div>
            </div>
            <div class="entry-section">
                <div class="row">
                    <datalist id="users">
                        {% for user in users %}
                            <option>{{ user.name }}</option>
                        {% endfor %}
                    </datalist>
                    <datalist id="colors">
                        {% for color in colors %}
                            <option>{{ color }}</option>
                        {% endfor %}
                    </datalist>
                    <input type="text" name="name0" placeholder="Trip Leader" class="col-xl-4" value="{{ patrollers[0]['name'] }}" list="users" required/>
                    <input type="text" name="callsign0" placeholder="Call Sign" class="col-xl-2" value="{{ patrollers[0]['call_sign'] }}" required/>
                    <input type="text" name="packcolor0" placeholder="Pack Color" class="col-xl-2" value="{{ patrollers[0]['pack_color'] }}" list="colors" required/>
                    <input type="text" name="tentcolor0" placeholder="Tent Color" class="col-xl-2" value="{{ patrollers[0]['tent_color'] }}" list="colors" required/>
                    <input type="text" name="flycolor0" placeholder="Fly Color" class="col-xl-2" value="{{ patrollers[0]['fly_color'] }}" list="colors" required/>
                </div>
                {% for p in patrollers[1:] %}
                    <div class="row">
                        <input type="text" name="name{{ loop.index }}" placeholder="Name" class="col-xl-4" value="{{ p['name'] }}" list="users"/>
                        <input type="text" name="callsign{{ loop.index }}" placeholder="Call Sign" class="col-xl-2" value="{{ p['call_sign'] }}"/>
                        <input type="text" name="packcolor{{ loop.index }}" placeholder="Pack Color" class="col-xl-2" value="{{ p['pack_color'] }}" list="colors" />
                        <input type="text" name="tentcolor{{ loop.index }}" placeholder="Tent Color" class="col-xl-2" value="{{ p['tent_color'] }}" list="colors" />
                        <input type="text" name="flycolor{{ loop.index }}" placeholder="Fly Color" class="col-xl-2" value="{{ p['fly_color'] }}" list="colors" />
                    </div>
                {% endfor %}
            </div>

            <div class="entry-section">
                <datalist id="mode">
                    <option>Foot</option>
                    <option>Stock</option>
                    <option>Boat</option>
                </datalist>
                {% for d in day_plans %}
                    <div class="row">
                        <input type="date" name="date{{ loop.index0 }}" title="Date:" class="col-xl-1 date-input" value="{{ d['date'] }}"/>
                        <input type="text" name="start{{ loop.index0 }}" placeholder="Starting Point:" class="col-xl-3" value="{{ d['start'] }}" list="locations"/>
                        <input type="text" name="end{{ loop.index0 }}" placeholder="Ending Point:" class="col-xl-3" value="{{ d['end'] }}" list="locations"/>
                        <input type="text" name="route{{ loop.index0 }}" placeholder="Route:" class="col-xl-4" value="{{ d['route'] }}"/>
                        <input type="text" name="mode{{ loop.index0 }}" placeholder="Mode:" class="col-xl-1" value="{{ d['mode'] }}" list="mode"/>
                    </div>
                {% endfor %}
            </div>

            <div class="entry-section">
                <div class="row">
                    <datalist id="cars">
                        {% for car in cars %}
                            <option>{{ car }}</option>
                        {% endfor %}
                    </datalist>
                    <input type="text" name="carplate" placeholder="License Plate" class="col-xl-4" value="{{ car_plate }}" list="cars">
                    <input type="text" name="carmake" placeholder="Make" class="col-xl-3" value="{{ car_make }}">
                    <input type="text" name="carmodel" placeholder="Model" class="col-xl-3" value="{{ car_model }}">
                    <input type="text" name="carcolor" placeholder="Color" class="col-xl-2" value="{{ car_color }}" list="colors">
                </div>
                <row>
                    <input type="text" name="carlocation" placeholder="Car Location" class="col-xl-6" value="{{ car_location }}">
                </row>
            </div>

            <div class="entry-section">
                <div class="form-check">
                    <input type="checkbox" name="bivygear" id="bivygear" {% if bivy_gear %}checked{% else %}{% endif %}>
                    <label for="bivygear" class="form-check-label">Bivy Gear</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="compass" id="compass" {% if compas %}checked{% else %}{% endif %}>
                    <label for="compass" class="form-check-label">Compass</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="firstaidkit" id="firstaidkit" {% if first_aid_kit %}checked{% else %}{% endif %}>
                    <label for="firstaidkit" class="form-check-label">First Aid Kit</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="flagging" id="flagging" {% if flagging %}checked{% else %}{% endif %}>
                    <label for="flagging" class="form-check-label">Flagging</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="flare" id="flare" {% if flare %}checked{% else %}{% endif %}>
                    <label for="flare" class="form-check-label">flare</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="flashlight" id="flashlight" {% if flashlight %}checked{% else %}{% endif %}>
                    <label for="flashlight" class="form-check-label">Flashlight</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="gps" id="gps" {% if gps %}checked{% else %}{% endif %}>
                    <label for="gps" class="form-check-label">GPS</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="headlamp" id="headlamp" {% if head_lamp %}checked{% else %}{% endif %}>
                    <label for="headlamp" class="form-check-label">Head Lamp</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="helmet" id="helmet" {% if helmet %}checked{% else %}{% endif %}>
                    <label for="helmet" class="form-check-label">Helmet</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="iceaxe" id="iceaxe" {% if ice_axe %}checked{% else %}{% endif %}>
                    <label for="iceaxe" class="form-check-label">Ice Axe</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="map" id="map" {% if map %}checked{% else %}{% endif %}>
                    <label for="map" class="form-check-label">Map</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="matches" id="matches" {% if matches %}checked{% else %}{% endif %}>
                    <label for="matches" class="form-check-label">Matches</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="probepole" id="probepole" {% if probe_pole %}checked{% else %}{% endif %}>
                    <label for="probepole" class="form-check-label">Probe Pole</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="radio" id="radio" {% if radio %}checked{% else %}{% endif %}>
                    <label for="radio" class="form-check-label">Radio</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="rope" id="rope" {% if rope %}checked{% else %}{% endif %}>
                    <label for="rope" class="form-check-label">Rope</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="shovel" id="shovel" {% if shovel %}checked{% else %}{% endif %}>
                    <label for="shovel" class="form-check-label">Shovel</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="signalmirror" id="signalmirror" {% if signal_mirror %}checked{% else %}{% endif %}>
                    <label for="signalmirror" class="form-check-label">Signal Mirror</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="spaceblanket" id="spaceblanket" {% if space_blanket %}checked{% else %}{% endif %}>
                    <label for="spaceblanket" class="form-check-label">Space Blanket</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="sparebattery" id="sparebattery" {% if spare_battery %}checked{% else %}{% endif %}>
                    <label for="sparebattery" class="form-check-label">Spare Battery</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="tent" id="tent" {% if tent %}checked{% else %}{% endif %}>
                    <label for="tent" class="form-check-label">Tent</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="whistle" id="whistle" {% if whistle %}checked{% else %}{% endif %}>
                    <label for="whistle" class="form-check-label">Whistle</label>
                </div>

                <input type="number" name="daysoffood" placeholder="Days Worth of Food" class="col-xl-6" value="{{ days_of_food }}" step="any"/>
                <input type="text" name="weapon" placeholder="Weapon?" class="col-xl-6" value="{{ weapon }}"/>
                <input type="text" name="radiomonitortime" placeholder="Time You Monitor Radio" class="col-xl-6" value="{{ radio_monitor_time }}"/>
                <div class="col-xl-7" title="Off trail map included?">
                    Off-trail travel?
                    <label class="radio-inline">
                        <input type="radio" name="offtrailtravel" id="offtrail1" value="yes" {% if off_trail_travel %}checked{% else %}{% endif %}>
                        Yes
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="offtrailtravel" id="offtrail2" value="no" {% if not off_trail_travel %}checked{% else %}{% endif %}>
                        No
                    </label>
                    <input type="file" name="offtrailtravelmapfile">
                </div>
                <input type="text" name="cellnumber" placeholder="Cell phone #" class="col-xl-6" value="{{ cell_number }}"/>
                <input type="text" name="satellitenumber" placeholder="Satellite Phone #" class="col-xl-6" value="{{ satellite_number }}"/>
            </div>

            <div class="entry-section">
                <datalist id="emails">
                    {% for user in users %}
                        <option>{{ user.email }}</option>
                    {% endfor %}
                </datalist>
                <div class="row">
                    <input type="text" name="contactemail0" placeholder="Responsible Party 1" class="col-xl-3" value="{{ contact_email0 }}" list="emails" required/>
                    <input type="text" name="contactwork0" placeholder="Work Phone" class="col-xl-3" value="{{ contact_work0 }}"/>
                    <input type="text" name="contacthome0" placeholder="Home Phone" class="col-xl-3" value="{{ contact_home0 }}"/>
                    <input type="text" name="contactcell0" placeholder="Cell Phone" class="col-xl-3" value="{{ contact_cell0 }}"/>
                </div>
                <div class="row">
                    <input type="text" name="contactemail1" placeholder="Responsible Party 2" class="col-xl-3" value="{{ contact_email1 }}" list="emails" required/>
                    <input type="text" name="contactwork1" placeholder="Work Phone" class="col-xl-3" value="{{ contact_work1 }}"/>
                    <input type="text" name="contacthome1" placeholder="Home Phone" class="col-xl-3" value="{{ contact_home1 }}"/>
                    <input type="text" name="contactcell1" placeholder="Cell Phone" class="col-xl-3" value="{{ contact_cell1 }}"/>
                </div>
            </div>

            <div class="entry-section">
                <div class="row">
                    <div class="col-xl-2">
                        Risk Calculation
                    </div>
                    <div class="col-xl-10">
                        1 = No Risk, 10 = Extreme Risk
                    </div>
                </div>
                <div class="row set-height">
                    <div class="col-sm-1 risk-label">
                        TM
                    </div>
                    <div class="col-sm-1 risk-label" >
                        Supervision
                    </div>
                    <div class="col-sm-1 risk-label">
                        Planning
                    </div>
                    <div class="col-sm-1 risk-label">
                        Contingency Resources
                    </div>
                    <div class="col-sm-1 risk-label">
                        Communication
                    </div>
                    <div class="col-sm-1 risk-label">
                        Team Selection
                    </div>
                    <div class="col-sm-1 risk-label">
                        Team Fitness
                    </div>
                    <div class="col-sm-1 risk-label">
                        Environment
                    </div>
                    <div class="col-sm-1 risk-label">
                        Incident Complexity
                    </div>
                </div>
                {% for p in patrollers %}
                    <div class="row">
                        <span class="col-sm-1">{{ loop.index }}</span>
                        <input type="number" name="s{{ loop.index0 }}" class="col-sm-1" value="{{ p['s'] }}"/>
                        <input type="number" name="p{{ loop.index0 }}" class="col-sm-1" value="{{ p['p'] }}"/>
                        <input type="number" name="cr{{ loop.index0 }}" class="col-sm-1" value="{{ p['cr'] }}"/>
                        <input type="number" name="c{{ loop.index0 }}" class="col-sm-1" value="{{ p['c'] }}"/>
                        <input type="number" name="ts{{ loop.index0 }}" class="col-sm-1" value="{{ p['ts'] }}"/>
                        <input type="number" name="tf{{ loop.index0 }}" class="col-sm-1" value="{{ p['tf'] }}"/>
                        <input type="number" name="e{{ loop.index0 }}" class="col-sm-1" value="{{ p['e'] }}"/>
                        <input type="number" name="ic{{ loop.index0 }}" class="col-sm-1" value="{{ p['ic'] }}"/>
                    </div>
                {% endfor %}
                <div class="row">
                    <span class="col-sm-1">Avg</span>
                    <input type="text" name="savg" class="col-sm-1" disabled/>
                    <input type="text" name="pavg" class="col-sm-1" disabled/>
                    <input type="text" name="cravg" class="col-sm-1" disabled/>
                    <input type="text" name="cavg" class="col-sm-1" disabled/>
                    <input type="text" name="tsavg" class="col-sm-1" disabled/>
                    <input type="text" name="tfavg" class="col-sm-1" disabled/>
                    <input type="text" name="eavg" class="col-sm-1" disabled/>
                    <input type="text" name="icavg" class="col-sm-1" disabled/>
                </div>
                <div class="row">
                    <span class="col-xl-1">Total Avg</span>
                    <input type="text" name="garavg" class="col-sm-1"/>
                </div>
                <div>
                    Discuss as a group how to manage and mitigate these risks and then the reasons.
                </div>
                <div class="row">
                    <span class="col-xl-1"></span>
                    <input type="number" name="mitigatedgar" value="{{ mitigated_gar }}" class="col-sm-1" step="any"/>
                </div>
                <div>
                    Hazards identified and mitigations taken: radio dead spots, river crossings, weather forecasts, snow/ice, insects/animals, other-specify.
                </div>
                <div class="row">
                    <span class="col-xl-1"></span>
                    <input type="text" placeholder="GAR Justification" name="garmitigations" value="{{ gar_justification }}" class="col-sm-11"/>
                </div>
                <div>
                    Additional notes:
                </div>
                <div class="row">
                    <span class="col-xl-1"></span>
                    <input type="text" placeholder="Notes:" name="notes" value="{{ notes }}" class="col-sm-11"/>
                </div>
            </div>

            {% if error %}
                <div class="error-msg">{{ error }}</div>
            {% endif %}

            <button type="submit" class="btn btn-danger">Submit</button>
        </form>
    </div>
{% endblock %}

{% block additional_js %}
    <script src="{{ url_for('static', filename='js/plan_entry.js') }}"></script>
{% endblock %}
